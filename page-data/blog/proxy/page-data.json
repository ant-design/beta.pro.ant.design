{"componentChunkName":"component---src-templates-docs-tsx","path":"/blog/proxy","result":{"data":{"markdownRemark":{"html":"<p>Today, at the front and rear ends, cross-domain has become the basic knowledge that every front-end engineer needs to understand, and the Nikkei topic in various interview questions. This article is intended to summarize the past and present of the same-origin strategy and how to solve it.</p>\n<h3 id=\"same-origin-strategy\" style=\"position:relative;\"><a href=\"#same-origin-strategy\" aria-label=\"same origin strategy permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Same-origin strategy</h3>\n<p>In <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/Security/Same-origin_policy\">MDN</a> we can see that the same-origin policy is a security mechanism. The detailed description is as follows:</p>\n<blockquote>\n<p>The same-origin policy limits how documents or scripts loaded from the same source interact with resources from another source. This is an important security mechanism for isolating potentially malicious files.</p>\n</blockquote>\n<p>The starting point of this mechanism is very good, but the restrictions on homology are very strict. Any difference in url and port will cause cross-domain errors.</p>\n<p>And you won't find any problems in the console. This is becoming more and more common as front and rear separations become more common. So how should it be solved?</p>\n<p><img src=\"https://gw.alipayobjects.com/zos/antfincdn/NIALgXw4QG/1574263212481-55d42245-f348-4f55-8508-4475f7e1f05d.png\" alt=\"图像 1.png\"></p>\n<p>The same-origin policy is called \"Bubble-to-Domain Strategy\", which is a security mechanism built into the browser. Then we don't want to use a browser request to solve the problem perfectly. The most convenient for the front end is naturally node.js.</p>\n<h3 id=\"used-in-development\" style=\"position:relative;\"><a href=\"#used-in-development\" aria-label=\"used in development permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Used in development</h3>\n<p>All scaffolding on the market now provides <a href=\"https://webpack.js.org/configuration/dev-server/#devserverproxy\">proxy</a> capabilities based on <a href=\"https://github\">http-proxy-middleware</a> .com/chimurai/http-proxy-middleware), this package can forward all requests that match the regular match to an address. Here is a easy demo:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> express <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'express'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> proxy <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http-proxy-middleware'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">var</span> app <span class=\"token operator\">=</span> <span class=\"token function\">express</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\napp<span class=\"token punctuation\">.</span><span class=\"token function\">use</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/api'</span><span class=\"token punctuation\">,</span> <span class=\"token function\">proxy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> target<span class=\"token operator\">:</span> <span class=\"token string\">'http://www.example.org'</span><span class=\"token punctuation\">,</span> changeOrigin<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\napp<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token number\">3000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// http://localhost:3000/api/foo/bar -> http://www.example.org/api/foo/bar</span></code></pre></div>\n<p>This configuration can forward all requests starting with <code>/api</code> to <code>http://www.example.org/</code> with all the arguments, including headers and cookies. One thing to note is that the view in the browser console is still <code>http://localhost:3000/api/xxx</code> and the conversion steps are done in node.js.</p>\n<p>In Pro, it is easier to configure with [proxy] in <a href=\"https://github.com/ant-design/ant-design-pro/blob/4c6a11eedad8baee97022ee452cedc76f097421a/config/config.ts#L185\">config.ts</a>. Configuration may be like this:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"> proxy<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">'/server/api/'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      target<span class=\"token operator\">:</span> <span class=\"token string\">'https://preview.pro.ant.design/'</span><span class=\"token punctuation\">,</span>\n      changeOrigin<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n      pathRewrite<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">'^/server'</span><span class=\"token operator\">:</span> <span class=\"token string\">''</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div>\n<p>Detailed configuration recommendations directly look at the configuration of <a href=\"https://webpack.js.org/configuration/dev-server/#devserverproxy\">webpack-dev</a>.</p>\n<h3 id=\"cors\" style=\"position:relative;\"><a href=\"#cors\" aria-label=\"cors permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>CORS</h3>\n<p>If you think that the above changes require more configuration, the system is easy and you don't need to introduce new complexity. We can use <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS\"><code>CORS</code></a> to allow cross-domain calls, which can be set in express:</p>\n<h4 id=\"express-config\" style=\"position:relative;\"><a href=\"#express-config\" aria-label=\"express config permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>express config</h4>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">res<span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Access-Control-Allow-Origin'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'你的项目地址，用*将会带来安全问题'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nres<span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Access-Control-Allow-Headers'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nres<span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Access-Control-Allow-Methods'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'*'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nres<span class=\"token punctuation\">.</span><span class=\"token function\">header</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Content-Type'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'application/json;charset=utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h4 id=\"nginx-config\" style=\"position:relative;\"><a href=\"#nginx-config\" aria-label=\"nginx config permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>nginx config</h4>\n<div class=\"gatsby-highlight\" data-language=\"nginx\"><pre class=\"language-nginx\"><code class=\"language-nginx\"><span class=\"token keyword\">location</span> <span class=\"token operator\">^</span><span class=\"token operator\">~</span> <span class=\"token operator\">/</span>api <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">proxy_set_header</span> Origin <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">add_header</span> Access<span class=\"token operator\">-</span>Control<span class=\"token operator\">-</span><span class=\"token keyword\">Allow</span><span class=\"token operator\">-</span>Credentials <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">add_header</span> Access<span class=\"token operator\">-</span>Control<span class=\"token operator\">-</span><span class=\"token keyword\">Allow</span><span class=\"token operator\">-</span>Headers <span class=\"token variable\">$http_access_control_request_headers</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">add_header</span> Access<span class=\"token operator\">-</span>Control<span class=\"token operator\">-</span><span class=\"token keyword\">Allow</span><span class=\"token operator\">-</span>Methods POST<span class=\"token punctuation\">,</span>GET<span class=\"token punctuation\">,</span>OPTIONS<span class=\"token punctuation\">,</span>DELETE<span class=\"token punctuation\">,</span>PUT<span class=\"token punctuation\">,</span>HEAD<span class=\"token punctuation\">,</span>PATCH<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">add_header</span> Access<span class=\"token operator\">-</span>Control<span class=\"token operator\">-</span><span class=\"token keyword\">Allow</span><span class=\"token operator\">-</span>Origin <span class=\"token variable\">$http_origin</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">add_header</span> Access<span class=\"token operator\">-</span>Control<span class=\"token operator\">-</span>Expose<span class=\"token operator\">-</span>Headers <span class=\"token variable\">$http_access_control_request_headers</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$request_method</span> <span class=\"token operator\">=</span> <span class=\"token string\">'OPTIONS'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token number\">204</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token variable\">$request_method</span> <span class=\"token operator\">!=</span> <span class=\"token string\">'OPTIONS'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">proxy_pass</span> <span class=\"token string\">\"your serve url\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<p>It should be noted that before the current version of nginx 1.7.5, add_header is only effective for 2xx and 3xx requests. Headers of 5xx cannot add headers and will still be intercepted by the browser ’s cross-domain policy. Errors contained in the body of 5xx requests The information cannot be obtained by the front end.</p>\n</blockquote>\n<h4 id=\"java-config\" style=\"position:relative;\"><a href=\"#java-config\" aria-label=\"java config permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>java config</h4>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">import</span> <span class=\"token namespace\">javax<span class=\"token punctuation\">.</span>servlet<span class=\"token punctuation\">.</span>http<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">HttpServletRequest</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">javax<span class=\"token punctuation\">.</span>servlet<span class=\"token punctuation\">.</span>http<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">HttpServletResponse</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HttpErrorResponseUtil</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">void</span> <span class=\"token function\">setResponeCorsHeader</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      response<span class=\"token punctuation\">.</span><span class=\"token function\">addHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Access-Control-Allow-Credentials\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"true\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      response<span class=\"token punctuation\">.</span><span class=\"token function\">addHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Access-Control-Allow-Methods\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"POST,GET,OPTIONS,DELETE,PUT,HEAD,PATCH\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      response<span class=\"token punctuation\">.</span><span class=\"token function\">addHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Access-Control-Allow-Origin\"</span><span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Origin\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      response<span class=\"token punctuation\">.</span><span class=\"token function\">addHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Access-Control-Allow-Headers\"</span><span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">.</span><span class=\"token function\">getHeader</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Access-Control-Request-Headers\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>The methods are similar in other languages. The most important one is the corresponding setting of the <code>Access-Control-Allow-Origin</code> <code>Access-Control-Allow-Headers</code> <code>Access-Control-Allow-Methods</code> header.</p>\n<p>It is highly recommended that everyone read through MDN's <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Access_control_CORS\">HTTP Access Control</a>, and this illustrated article can resolve cross-domain percentages. Eighty doubts.</p>\n<h3 id=\"advanced-usage\" style=\"position:relative;\"><a href=\"#advanced-usage\" aria-label=\"advanced usage permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Advanced usage</h3>\n<p>n development we may need to distinguish between multiple situations, such as the development environment, test environment, grammar environment, and the environment variables we can use in Pro to achieve this requirement.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> serveUrlMap <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  dev<span class=\"token operator\">:</span> <span class=\"token string\">'https://dev.pro.ant.design/'</span><span class=\"token punctuation\">,</span>\n  pre<span class=\"token operator\">:</span> <span class=\"token string\">'https://pre.pro.ant.design/'</span><span class=\"token punctuation\">,</span>\n  test<span class=\"token operator\">:</span> <span class=\"token string\">'https://test.pro.ant.design/'</span><span class=\"token punctuation\">,</span>\n  idc<span class=\"token operator\">:</span> <span class=\"token string\">'https://idc.pro.ant.design/'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token constant\">SERVE_ENV</span> <span class=\"token operator\">=</span> <span class=\"token string\">'idc'</span> <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ....</span>\n  proxy<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">'/server/api/'</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      target<span class=\"token operator\">:</span> serveUrlMap<span class=\"token punctuation\">[</span><span class=\"token constant\">SERVE_ENV</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n      changeOrigin<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n      pathRewrite<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">'^/server'</span><span class=\"token operator\">:</span> <span class=\"token string\">''</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>We can quickly switch by configuring various shortcut commands in package.json.</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"scripts\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"start:dev\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cross-env SERVE_ENV=dev umi dev\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"start:pre\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cross-env SERVE_ENV=pre umi dev\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"start:test\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"cross-env SERVE_ENV=test umi dev\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<blockquote>\n<p>It is worth noting here that the environment of config.ts is the environment of node.js, which can not use the behavior of dom and browser.</p>\n</blockquote>","tableOfContents":"<ul>\n<li><a href=\"/blog/proxy/#same-origin-strategy\">Same-origin strategy</a></li>\n<li><a href=\"/blog/proxy/#used-in-development\">Used in development</a></li>\n<li>\n<p><a href=\"/blog/proxy/#cors\">CORS</a></p>\n<ul>\n<li><a href=\"/blog/proxy/#express-config\">express config</a></li>\n<li><a href=\"/blog/proxy/#nginx-config\">nginx config</a></li>\n<li><a href=\"/blog/proxy/#java-config\">java config</a></li>\n</ul>\n</li>\n<li><a href=\"/blog/proxy/#advanced-usage\">Advanced usage</a></li>\n</ul>","frontmatter":{"title":"Same-origin policy cross-domain and agent","order":7,"type":"Blog"},"fields":{"path":"/blog/proxy.en-US.md","slug":"/blog/proxy","modifiedTime":1619001768523,"avatarList":"[{\"username\":\"chenshuai2144\",\"url\":\"https://avatars.githubusercontent.com/u/8186664?s=40&v=4\"}]"}},"allMarkdownRemark":{"edges":[{"node":{"frontmatter":{"title":"黑色主题和动态切换","order":8,"type":"Blog","time":"2019-12-25T00:00:00.000Z"},"fields":{"slug":"/blog/dynamic-theme-cn","path":"/blog/dynamic-theme.zh-CN.md"}}},{"node":{"frontmatter":{"title":"Black theme and dynamic switching","order":8,"type":"Blog","time":"2019-12-25T00:00:00.000Z"},"fields":{"slug":"/blog/dynamic-theme","path":"/blog/dynamic-theme.en-US.md"}}},{"node":{"frontmatter":{"title":"Layout New Style","order":8,"type":"Blog","time":"2020-04-21T00:00:00.000Z"},"fields":{"slug":"/blog/layout-new-style","path":"/blog/layout-new-style.en-US.md"}}},{"node":{"frontmatter":{"title":"Layout 的全新样式","order":8,"type":"Blog","time":"2020-04-21T00:00:00.000Z"},"fields":{"slug":"/blog/layout-new-style-cn","path":"/blog/layout-new-style.zh-CN.md"}}},{"node":{"frontmatter":{"title":"Same-origin policy cross-domain and agent","order":7,"type":"Blog","time":"2019-11-24T00:00:00.000Z"},"fields":{"slug":"/blog/proxy","path":"/blog/proxy.en-US.md"}}},{"node":{"frontmatter":{"title":"同源策略 跨域与代理","order":7,"type":"Blog","time":"2019-11-24T00:00:00.000Z"},"fields":{"slug":"/blog/proxy-cn","path":"/blog/proxy.zh-CN.md"}}},{"node":{"frontmatter":{"title":"Front-end best practices coming soon","order":7,"type":"Blog","time":"2020-02-29T00:00:00.000Z"},"fields":{"slug":"/blog/best-front0end","path":"/blog/best-front0end.en-US.md"}}},{"node":{"frontmatter":{"title":"前端最佳实践即将发布","order":7,"type":"Blog","time":"2020-02-29T00:00:00.000Z"},"fields":{"slug":"/blog/best-front0end-cn","path":"/blog/best-front0end.zh-CN.md"}}},{"node":{"frontmatter":{"title":"Quickly Builds CRUD's","order":7,"type":"Blog","time":"2020-03-01T00:00:00.000Z"},"fields":{"slug":"/blog/protable","path":"/blog/protable.en-US.md"}}},{"node":{"frontmatter":{"title":"ProTable 快速搭建 CRUD 的利器","order":7,"type":"Blog","time":"2020-03-01T00:00:00.000Z"},"fields":{"slug":"/blog/protable-cn","path":"/blog/protable.zh-CN.md"}}},{"node":{"frontmatter":{"title":"How do we deploy open source projects?","order":6,"type":"Blog","time":"2019-11-02T00:00:00.000Z"},"fields":{"slug":"/blog/deploy-pro","path":"/blog/deploy-pro.en-US.md"}}},{"node":{"frontmatter":{"title":"我们是如何部署开源项目的?","order":6,"type":"Blog","time":"2019-11-02T00:00:00.000Z"},"fields":{"slug":"/blog/deploy-pro-cn","path":"/blog/deploy-pro.zh-CN.md"}}},{"node":{"frontmatter":{"title":"Migration antd@4 Guide","order":6,"type":"Blog","time":"2020-01-16T00:00:00.000Z"},"fields":{"slug":"/blog/antd-4.0","path":"/blog/antd-4.0.en-US.md"}}},{"node":{"frontmatter":{"title":"迁移 antd@4 指南","order":6,"type":"Blog","time":"2020-01-16T00:00:00.000Z"},"fields":{"slug":"/blog/antd-4.0-cn","path":"/blog/antd-4.0.zh-CN.md"}}},{"node":{"frontmatter":{"title":"Better Block","order":5,"type":"Blog","time":"2019-06-28T00:00:00.000Z"},"fields":{"slug":"/blog/better-block","path":"/blog/better-block.en-US.md"}}},{"node":{"frontmatter":{"title":"Block 新升级","order":5,"type":"Blog","time":"2019-06-28T00:00:00.000Z"},"fields":{"slug":"/blog/better-block-cn","path":"/blog/better-block.zh-CN.md"}}},{"node":{"frontmatter":{"title":"Customize theme on runtime","order":1,"type":"Blog","time":"2019-05-07T00:00:00.000Z"},"fields":{"slug":"/blog/change-theme","path":"/blog/change-theme.en-US.md"}}},{"node":{"frontmatter":{"title":"在线更换主题","order":1,"type":"Blog","time":"2019-05-07T00:00:00.000Z"},"fields":{"slug":"/blog/change-theme-cn","path":"/blog/change-theme.zh-CN.md"}}},{"node":{"frontmatter":{"title":"Layout component of Ant Design Pro","order":1,"type":"Blog","time":"2019-05-08T00:00:00.000Z"},"fields":{"slug":"/blog/new-pro-use","path":"/blog/new-pro-use.en-US.md"}}},{"node":{"frontmatter":{"title":"Pro 的 Layout 组件","order":1,"type":"Blog","time":"2019-05-08T00:00:00.000Z"},"fields":{"slug":"/blog/new-pro-use-cn","path":"/blog/new-pro-use.zh-CN.md"}}},{"node":{"frontmatter":{"title":"Let's use eslint","order":1,"type":"Blog","time":"2019-06-21T00:00:00.000Z"},"fields":{"slug":"/blog/use-eslint-typescript","path":"/blog/use-eslint-typescript.en-US.md"}}},{"node":{"frontmatter":{"title":"一起来用 eslint 吧","order":1,"type":"Blog","time":"2019-06-21T00:00:00.000Z"},"fields":{"slug":"/blog/use-eslint-typescript-cn","path":"/blog/use-eslint-typescript.zh-CN.md"}}}]}},"pageContext":{"slug":"/blog/proxy","type":"/blog/","locale":"//"}},"staticQueryHashes":[]}